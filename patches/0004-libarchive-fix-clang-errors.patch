From 6d2a14fdb545adf54ae7f0516415b56a7567a9a1 Mon Sep 17 00:00:00 2001
From: Tung Huynh <tung75605@gmail.com>
Date: Mon, 11 Dec 2023 10:32:32 -0800
Subject: [PATCH 4/5] libarchive: fix clang errors

---
 contrib/src/libarchive/rules.mak | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/contrib/src/libarchive/rules.mak b/contrib/src/libarchive/rules.mak
index 9e094257da..343f290e2f 100644
--- a/contrib/src/libarchive/rules.mak
+++ b/contrib/src/libarchive/rules.mak
@@ -8,6 +8,7 @@ PKGS_FOUND += libarchive
 endif
 
 DEPS_libarchive = zlib
+LIBARCHIVE_EXTRA_CFLAGS := -Wno-error=implicit-function-declaration
 
 $(TARBALLS)/libarchive-$(LIBARCHIVE_VERSION).tar.gz:
 	$(call download_pkg,$(LIBARCHIVE_URL),libarchive)
@@ -27,7 +28,7 @@ endif
 
 .libarchive: libarchive
 	$(RECONF)
-	cd $< && $(HOSTVARS) ./configure $(HOSTCONF) \
+	cd $< && $(HOSTVARS) CFLAGS="$(CFLAGS) $(LIBARCHIVE_EXTRA_CFLAGS)" ./configure $(HOSTCONF) \
 		--disable-bsdcpio --disable-bsdtar --disable-bsdcat \
 		--without-nettle --without-cng \
 		--without-xml2 --without-lzma --without-iconv --without-expat
-- 
2.42.0.windows.2

